{"version":3,"sources":["webpack:///./app/widget/index/Shop/ActivityPublicity/main.js"],"names":["CATEGORY","shop","pro","DEFAULT_PAGE","pageNum","pageSize","App","props","goTo","path","data","pathObj","pathname","state","currentCat","shop_name","act_count","ser_day","_date","history","push","handleMoreClick","pagination","Object","assign","getProductPublicListShop","getCampaignShopsPageList","handleBtnClick","setState","flag","handleSearch","value","event","inputValue","handleChangeDay","currentDay","timestamp","params","moment","format","campaign_node","ajax","get","then","res","status","message","shops","error","catch","product_name","products","getSevenDayCardsData","sevenDayCards","Date","now","React","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AACA;;;;AACA;;;;;;;;;;;;AAEA,IAAMA,WAAW;AACfC,QAAM,MADS;AAEfC,OAAK;AAFU,CAAjB;;AAKA,IAAMC,eAAe;AACnBC,WAAS,CADU;AAEnBC,YAAU;AAFS,CAArB;;IAKMC,G;;;AACJ,eAAYC,KAAZ,EAAmB;AAAA;;AAAA,0GACXA,KADW;;AAAA,UAiBnBC,IAjBmB,GAiBZ,UAACC,IAAD,EAAOC,IAAP,EAAgB;AACrB,UAAMC,UAAU;AACdC,kBAAUH;AADI,OAAhB;AAGA,UAAI,MAAKI,KAAL,CAAWC,UAAX,KAA0Bd,SAASC,IAAvC,EAA6C;AAC3CU,gBAAQE,KAAR,GAAgB;AACdE,qBAAWL,KAAKK,SADF;AAEdC,qBAAWN,KAAKM,SAFF;AAGdC,mBAASP,KAAKQ;AAHA,SAAhB;AAKD;AACD,UAAI,MAAKL,KAAL,CAAWC,UAAX,KAA0Bd,SAASE,GAAvC,EAA4C;AAC1CS,gBAAQE,KAAR,GAAgB;AACdI,mBAASP,KAAKQ;AADA,SAAhB;AAGD;AACD,YAAKX,KAAL,CAAWY,OAAX,CAAmBC,IAAnB,CAAwBT,OAAxB;AACD,KAlCkB;;AAAA,UAmCnBU,eAnCmB,GAmCD,UAACjB,OAAD,EAAa;AAC7B,UAAI,MAAKS,KAAL,CAAWC,UAAX,KAA0Bd,SAASE,GAAvC,EAA4C;AAC1C,YAAMoB,aAAaC,OAAOC,MAAP,CAAc,EAAd,EAAkBrB,YAAlB,EAAgC,EAACC,gBAAD,EAAhC,CAAnB;AACA,cAAKqB,wBAAL,CAA8BH,UAA9B;AACD;AACD,UAAI,MAAKT,KAAL,CAAWC,UAAX,KAA0Bd,SAASC,IAAvC,EAA6C;AAC3C,YAAMqB,cAAaC,OAAOC,MAAP,CAAc,EAAd,EAAkBrB,YAAlB,EAAgC,EAACC,gBAAD,EAAhC,CAAnB;AACA,cAAKsB,wBAAL,CAA8BJ,WAA9B;AACD;AACF,KA5CkB;;AAAA,UA6CnBK,cA7CmB,GA6CF,gBAAQ;AACvB,YAAKC,QAAL,CAAc;AACZd,oBAAYe;AADA,OAAd;AAGD,KAjDkB;;AAAA,UAkDnBC,YAlDmB,GAkDJ,UAACC,KAAD,EAAQC,KAAR,EAAkB;AAC/B;AACA,YAAKJ,QAAL,CAAc;AACZK,oBAAYF;AADA,OAAd,EAEG,YAAM;AACP,YAAI,MAAKlB,KAAL,CAAWC,UAAX,KAA0Bd,SAASE,GAAvC,EAA4C;AAC1C,gBAAKuB,wBAAL,CAA8BtB,YAA9B;AACD;AACD,YAAI,MAAKU,KAAL,CAAWC,UAAX,KAA0Bd,SAASC,IAAvC,EAA6C;AAC3C,gBAAKyB,wBAAL,CAA8BvB,YAA9B;AACD;AACF,OATD;AAWD,KA/DkB;;AAAA,UAiEnB+B,eAjEmB,GAiED,qBAAa;AAC7B,YAAKN,QAAL,CAAc;AACZO,oBAAYC;AADA,OAAd,EAEG,YAAM;AACP,cAAKV,wBAAL,CAA8BvB,YAA9B;AACA,cAAKsB,wBAAL,CAA8BtB,YAA9B;AACD,OALD;AAMD,KAxEkB;;AAAA,UA0EnBuB,wBA1EmB,GA0EQ,UAACJ,UAAD,EAAgB;AACzC,UAAMe;AACJpB,iBAASqB,OAAO,MAAKzB,KAAL,CAAWsB,UAAlB,EAA8BI,MAA9B,CAAqC,YAArC,CADL;AAEJxB,mBAAW,MAAKF,KAAL,CAAWoB,UAFlB;AAGJ;AACAO,uBAAe;AAJX,SAKDlB,UALC,CAAN;AAOAmB,qBAAKC,GAAL,CAAS,yCAAT,EAAmD,EAACL,cAAD,EAAnD,EAA6DM,IAA7D,CAAkE,eAAO;AAAA,wBACrCC,IAAIlC,IADiC;AAAA,YAC/DA,IAD+D,aAC/DA,IAD+D;AAAA,YACzDmC,MADyD,aACzDA,MADyD;AAAA,YACjDC,OADiD,aACjDA,OADiD;;AAEvE,YAAID,WAAW,OAAf,EAAwB;AACtB,gBAAKjB,QAAL,CAAc;AACZmB,mBAAOxB,OAAOC,MAAP,CAAc,EAAd,EAAkBd,IAAlB,EAAwBY,UAAxB;AADK,WAAd;AAGD,SAJD,MAIO;AACL,4BAAI0B,KAAJ,CAAUF,OAAV;AACD;AACF,OATD,EASGG,KATH,CASS,eAAO;AACd,0BAAID,KAAJ,CAAU,aAAV;AACD,OAXD;AAYD,KA9FkB;;AAAA,UAgGnBvB,wBAhGmB,GAgGQ,UAACH,UAAD,EAAgB;AACzC,UAAMe;AACJpB,iBAASqB,OAAO,MAAKzB,KAAL,CAAWsB,UAAlB,EAA8BI,MAA9B,CAAqC,YAArC,CADL;AAEJW,sBAAc,MAAKrC,KAAL,CAAWoB;AAFrB,SAIDX,UAJC,CAAN;AAMAmB,qBAAKC,GAAL,CAAS,yCAAT,EAAoD,EAACL,cAAD,EAApD,EAA8DM,IAA9D,CAAmE,eAAO;AAAA,yBACtCC,IAAIlC,IADkC;AAAA,YAChEA,IADgE,cAChEA,IADgE;AAAA,YAC1DmC,MAD0D,cAC1DA,MAD0D;AAAA,YAClDC,OADkD,cAClDA,OADkD;;AAExE,YAAID,WAAW,OAAf,EAAwB;AACtB,gBAAKjB,QAAL,CAAc;AACZuB,sBAAU5B,OAAOC,MAAP,CAAc,EAAd,EAAkBd,IAAlB,EAAwBY,UAAxB;AADE,WAAd;AAGD,SAJD,MAIO;AACL,4BAAI0B,KAAJ,CAAUF,OAAV;AACD;AACF,OATD,EASGG,KATH,CASS,eAAO;AACd,0BAAID,KAAJ,CAAU,aAAV;AACD,OAXD;AAYD,KAnHkB;;AAAA,UAqHnBI,oBArHmB,GAqHI,YAAM;AAC3BX,qBAAKC,GAAL,CAAS,gCAAT,EAA2CC,IAA3C,CAAgD,eAAO;AAAA,yBACnBC,IAAIlC,IADe;AAAA,YAC7CA,IAD6C,cAC7CA,IAD6C;AAAA,YACvCmC,MADuC,cACvCA,MADuC;AAAA,YAC/BC,OAD+B,cAC/BA,OAD+B;;AAErD,YAAID,WAAW,OAAf,EAAwB;AACtB,gBAAKjB,QAAL,CAAc;AACZyB,2BAAe3C;AADH,WAAd;AAGD,SAJD,MAIO;AACL,4BAAIsC,KAAJ,CAAUF,OAAV;AACD;AACF,OATD,EASGG,KATH,CASS,eAAO;AACd,0BAAID,KAAJ,CAAU,aAAV;AACD,OAXD;AAYD,KAlIkB;;AAEjB,UAAKnC,KAAL,GAAa;AACXwC,qBAAe,EADJ;AAEXlB,kBAAYmB,KAAKC,GAAL,EAFD;AAGXzC,kBAAYd,SAASE,GAHV;AAIX+B,kBAAY,EAJD;;AAMXkB,gBAAU,EANC;AAOXJ,aAAO;AAPI,KAAb;AAFiB;AAWlB;;;;wCACmB;AAClB,WAAKK,oBAAL;AACA,WAAK3B,wBAAL,CAA8BtB,YAA9B;AACA,WAAKuB,wBAAL,CAA8BvB,YAA9B;AACD;AAgDD;;AASA;;AAsBA;;AAqBA;;;;6BAeS;AACP,aAAO,oBAAC,aAAD,IAAK,MAAM,IAAX,GAAP;AACD;;;;EAtIeqD,MAAMC,S;;kBAyITnD,G","file":"js/chunk/337_2ddc591d9cd3d6a8d5d8.js","sourcesContent":["import { message as Msg } from 'antd'\r\nimport Tpl from './tpl'\r\nimport ajax from '../../../../js/common/ajax'\r\n\r\nconst CATEGORY = {\r\n  shop: 'shop',\r\n  pro: 'pro',\r\n}\r\n\r\nconst DEFAULT_PAGE = {\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n}\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      sevenDayCards: [],\r\n      currentDay: Date.now(),\r\n      currentCat: CATEGORY.pro,\r\n      inputValue: '',\r\n\r\n      products: {},\r\n      shops: {},\r\n    }\r\n  }\r\n  componentDidMount() {\r\n    this.getSevenDayCardsData()\r\n    this.getProductPublicListShop(DEFAULT_PAGE)\r\n    this.getCampaignShopsPageList(DEFAULT_PAGE)\r\n  }\r\n  goTo = (path, data) => {\r\n    const pathObj = {\r\n      pathname: path,\r\n    }\r\n    if (this.state.currentCat === CATEGORY.shop) {\r\n      pathObj.state = {\r\n        shop_name: data.shop_name,\r\n        act_count: data.act_count,\r\n        ser_day: data._date,\r\n      }\r\n    }\r\n    if (this.state.currentCat === CATEGORY.pro) {\r\n      pathObj.state = {\r\n        ser_day: data._date,\r\n      }\r\n    }\r\n    this.props.history.push(pathObj)\r\n  }\r\n  handleMoreClick = (pageNum) => {\r\n    if (this.state.currentCat === CATEGORY.pro) {\r\n      const pagination = Object.assign({}, DEFAULT_PAGE, {pageNum})\r\n      this.getProductPublicListShop(pagination)\r\n    }\r\n    if (this.state.currentCat === CATEGORY.shop) {\r\n      const pagination = Object.assign({}, DEFAULT_PAGE, {pageNum})\r\n      this.getCampaignShopsPageList(pagination)\r\n    }\r\n  }\r\n  handleBtnClick = flag => {\r\n    this.setState({\r\n      currentCat: flag,\r\n    })\r\n  }\r\n  handleSearch = (value, event) => {\r\n    // console.log(value, event)\r\n    this.setState({\r\n      inputValue: value,\r\n    }, () => {\r\n      if (this.state.currentCat === CATEGORY.pro) {\r\n        this.getProductPublicListShop(DEFAULT_PAGE)\r\n      }\r\n      if (this.state.currentCat === CATEGORY.shop) {\r\n        this.getCampaignShopsPageList(DEFAULT_PAGE)\r\n      }\r\n    })\r\n    \r\n  }\r\n  // 切换日期\r\n  handleChangeDay = timestamp => {\r\n    this.setState({\r\n      currentDay: timestamp,\r\n    }, () => {\r\n      this.getCampaignShopsPageList(DEFAULT_PAGE)\r\n      this.getProductPublicListShop(DEFAULT_PAGE)\r\n    })\r\n  }\r\n  // 获取店铺分类活动\r\n  getCampaignShopsPageList = (pagination) => {\r\n    const params = {\r\n      ser_day: moment(this.state.currentDay).format('YYYY-MM-DD'),\r\n      shop_name: this.state.inputValue,\r\n      // ...DEFAULT_PAGE,\r\n      campaign_node: '已审核',\r\n      ...pagination,\r\n    }\r\n    ajax.get('/hcm/campgign/findCampaignShopsPageList',{params}).then(res => {\r\n      const { data, status, message } = res.data\r\n      if (status === '10000') {\r\n        this.setState({\r\n          shops: Object.assign({}, data, pagination)\r\n        })\r\n      } else {\r\n        Msg.error(message)\r\n      }\r\n    }).catch(err => {\r\n      Msg.error('系统繁忙，请稍后再试！')\r\n    })\r\n  }\r\n  // 获取产品分类活动\r\n  getProductPublicListShop = (pagination) => {\r\n    const params = {\r\n      ser_day: moment(this.state.currentDay).format('YYYY-MM-DD'),\r\n      product_name: this.state.inputValue,\r\n      // ...DEFAULT_PAGE,\r\n      ...pagination,\r\n    }\r\n    ajax.get('/hcm/campgign/findProductPublicListShop', {params}).then(res => {\r\n      const { data, status, message } = res.data\r\n      if (status === '10000') {\r\n        this.setState({\r\n          products: Object.assign({}, data, pagination)\r\n        })\r\n      } else {\r\n        Msg.error(message)\r\n      }\r\n    }).catch(err => {\r\n      Msg.error('系统繁忙，请稍后再试！')\r\n    })\r\n  }\r\n  // 获取7日卡片数据\r\n  getSevenDayCardsData = () => {\r\n    ajax.get('/hcm/campgign/ScheduleBMCSeven').then(res => {\r\n      const { data, status, message } = res.data\r\n      if (status === '10000') {\r\n        this.setState({\r\n          sevenDayCards: data,\r\n        })\r\n      } else {\r\n        Msg.error(message)\r\n      }\r\n    }).catch(err => {\r\n      Msg.error('系统繁忙，请稍后再试！')\r\n    })\r\n  }\r\n  render() {\r\n    return <Tpl that={this} />\r\n  }\r\n}\r\n\r\nexport default App"],"sourceRoot":""}