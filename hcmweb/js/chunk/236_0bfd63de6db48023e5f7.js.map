{"version":3,"sources":["webpack:///./app/widget/index/Brand/ActivityPublic/main.js"],"names":["App","props","handleDateChange","setState","currentDateIndex","params","index","currentDate","date","currentShopBtnIndex","getReviewedShop","type","format","getActivityList","state","pagination","handleTogglePriceClick","_index","activityList","list","slice","_isExpandPrice","handleLoadMoreBtnClick","console","log","campaign_node","ser_day","pageSize","pageNum","shopid","LoadingModal","bl","axios","post","shop_id","then","res","data","status","catch","message","error","handleShopBtnChange","undefined","method","url","length","map","Object","assign","v","count","shopBtnList","getSevenDayActivity","sevenDayNums","React","Component"],"mappings":"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","file":"js/chunk/236_0bfd63de6db48023e5f7.js","sourcesContent":["import Tpl from './tpl'\r\nimport axios from '../../../../js/common/ajax'\r\nimport { message as Msg } from 'antd'\r\nimport moment from 'moment'\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      sevenDayNums: [],\r\n      shopBtnList: [],\r\n      currentDateIndex: 0,\r\n      currentDate: moment().format('YYYY-MM-DD'),\r\n      currentShopBtnIndex: 0,\r\n      activityList: [],\r\n      pagination: {\r\n        pageNum: 1,\r\n        pageSize: 10,\r\n        count: 0\r\n      },\r\n      type: null,\r\n    ser_day: null,\r\n    pageSize: null,\r\n    pageNum: null,\r\n    campaign_node:'已审核',\r\n    shopid:''\r\n      // isExpandPrice: false\r\n    }\r\n  }\r\n  componentWillMount() {\r\n    this.getSevenDayActivity()\r\n    this.getReviewedShop({\r\n      type: 1,\r\n      date: this.state.currentDate\r\n    })\r\n    this.getActivityList({\r\n      type: 1,\r\n      date: this.state.currentDate,\r\n      pageNum: this.state.pagination.pageNum,\r\n      pageSize: this.state.pagination.pageSize\r\n    })\r\n  }\r\n  handleDateChange = params => {\r\n    this.setState({\r\n      currentDateIndex: params.index,\r\n      currentDate: params.date,\r\n      currentShopBtnIndex: 0\r\n    }, () => {\r\n      // console.log(params.date, this.state.currentDate)\r\n      this.getReviewedShop({\r\n        type: params.date === moment().format('YYYY-MM-DD') ? 1 : 2,\r\n        date: params.date\r\n      })\r\n      this.getActivityList({\r\n        type: params.date === moment().format('YYYY-MM-DD') ? 1 : 2,\r\n        date: params.date,\r\n        ...this.state.pagination\r\n      })\r\n    })\r\n  }\r\n  handleTogglePriceClick = (_index) => {\r\n    // console.log(123)\r\n    const { activityList } = this.state\r\n    const list = activityList.slice()\r\n    list[_index]._isExpandPrice = !list[_index]._isExpandPrice\r\n    this.setState({\r\n      // isExpandPrice: !this.state.isExpandPrice\r\n      activityList: list\r\n    })\r\n  }\r\n  handleLoadMoreBtnClick = () => {\r\n    console.log()\r\n    let {\r\n        campaign_node,\r\n        type,\r\n        ser_day,\r\n        pageSize,\r\n        pageNum,\r\n        activityList,\r\n        pagination,\r\n        shopid\r\n      } = this.state;\r\n      pageNum++\r\n      LoadingModal({bl:true})\r\n      axios.post('/hcm/campgign/ScheduleBMC', {\r\n        campaign_node,\r\n        type,\r\n        ser_day,\r\n        pageSize,\r\n        pageNum,\r\n        shop_id:shopid?shopid:null\r\n    }).then(res=>{\r\n        console.log(res)\r\n        LoadingModal({bl:false})\r\n        if (res.data.status == '10000') {\r\n            console.log(pageNum)\r\n            pagination.pageNum = pageNum\r\n            this.setState({activityList:res.data.data.list,pageNum,pagination})\r\n        }\r\n    }).catch(()=>{\r\n        LoadingModal({bl:false})\r\n        message.error('获取信息失败')\r\n    })\r\n\r\n  }\r\n//   组件的事件-----备注为了好看\r\n  handleShopBtnChange = params => {\r\n    this.setState({\r\n      currentShopBtnIndex: params.index\r\n    })\r\n    // shop_id需要格式'id','id'...\r\n    this.getActivityList({\r\n      type: moment().format('YYYY-MM-DD') === this.state.currentDate ? 1 : 2,\r\n      date: this.state.currentDate,\r\n      shop_id: params.shop_id === undefined ? '' : `'${params.shop_id}'`,\r\n      ...this.state.pagination\r\n    })\r\n  }\r\n  // 获取活动列表\r\n  getActivityList = params => {\r\n      console.log(params)\r\n    let data = {\r\n      campaign_node: '已审核',\r\n      type: params.type,\r\n      ser_day: params.date,\r\n      pageSize: params.pageSize,\r\n      pageNum: params.pageNum\r\n    }\r\n    let {pagination} = this.state;\r\n    if (params.shop_id !== undefined && params.shop_id !== '') {\r\n      data.shop_id = params.shop_id\r\n    }\r\n    axios({\r\n      method: 'post',\r\n      url: '/hcm/campgign/ScheduleBMC',\r\n      data\r\n    }).then(res => {\r\n      const { data, status, message } = res.data\r\n      if (status === '10000') {\r\n        // pagination.pageNum = 1\r\n        let {shopid} = this.state;\r\n        if (params.shop_id !== undefined && params.shop_id !== '') {\r\n            shopid = params.shop_id\r\n        } else{\r\n            shopid = ''\r\n        }\r\n        this.setState({\r\n          activityList: !!data.list.length?data.list.map(v => Object.assign({},v,{_isExpandPrice:false})):[],\r\n          pagination: Object.assign({}, this.state.pagination, {count: data.count,pageNum:1}),\r\n          type: params.type,\r\n          ser_day: params.date,\r\n          pageSize: params.pageSize,\r\n          pageNum: 1,\r\n          shopid\r\n        })\r\n      }\r\n    }).catch()\r\n  }\r\n  // 获取已审核店铺\r\n  getReviewedShop = params => {\r\n    axios({\r\n      method: 'post',\r\n      url: '/hcm/campgign/PublicShops',\r\n      data: {\r\n        campaign_node: \"已审核\",\r\n        type: params.type,\r\n        ser_day: params.date\r\n      }\r\n    }).then(res => {\r\n      const { data, status, message } = res.data\r\n      if (status === '10000') {\r\n        this.setState({\r\n          shopBtnList: data\r\n        })\r\n      }\r\n    }).catch()\r\n  }\r\n  // 获取七日活动信息\r\n  getSevenDayActivity = () => {\r\n    axios({\r\n      method: 'post',\r\n      url: '/hcm/campgign/ScheduleBMCSeven',\r\n    }).then(res => {\r\n      const { data, status, message } = res.data\r\n      if (status === '10000') {\r\n        this.setState({\r\n          sevenDayNums: data\r\n        })\r\n      }\r\n    }).catch()\r\n  }\r\n  render() {\r\n    return <Tpl that={this} />\r\n  }\r\n}\r\n\r\nexport default App"],"sourceRoot":""}