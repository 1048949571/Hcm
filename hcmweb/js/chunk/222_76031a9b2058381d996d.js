(window.webpackJsonp=window.webpackJsonp||[]).push([[222],{433:function(t,e){},554:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=p(a(201)),s=p(a(35)),i=p(a(33)),l=p(a(14)),o=p(a(11)),r=p(a(32)),c=p(a(15)),u=p(a(30)),d=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();a(200),a(34),a(41),a(18),a(22),a(42),a(16),a(31);var f=p(a(12));function p(t){return t&&t.__esModule?t:{default:t}}var m=u.default.Option,h=function(e){function a(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));return e.showModal=function(t,a){var n,s,i;e.setState((i=a,(s=t)in(n={})?Object.defineProperty(n,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[s]=i,n),function(){e.state.shopVisible?e.getShopList():e.state.itemVisible&&(e.getSingletProList(),e.getProductClassify())})},e.addShop=function(){var t=e.state.shopData;t.selectData.push({id:"",shop_name:"123"}),e.setState({shopData:t})},e.rmShop=function(t){var a=e.state.shopData;1!=a.selectData.length?(a.selectData.splice(t,1),e.setState({shopData:a})):c.default.warning("最少保留一条")},e.onShopSelect=function(t,a){var n=e.state.shopData;n.selectData[a]=n.listData.filter(function(e){return e.id==t})[0],e.setState({shopData:n})},e.getShopList=function(){f.default.get("/hcm/hcmShop/getShopListByBmcid").then(function(t){if("10000"==t.data.status){var a=e.state.shopData,n=t.data.data;a.selectData=n.filter(function(t,e){return t.focus}),a.listData=n,e.setState({shopData:a})}else c.default.error(t.data.message)}).catch(function(t){c.default.error(t.statusText)})},e.handleshopOk=function(){var t=e.state.shopData,a=t.selectData.map(function(t){return t.id});if(0!=t.selectData.length){for(var n=0;n<a.length;n++)if(""==a[n])return void c.default.warning("第"+(n+1)+"条数据未选择店铺，请选择后提交！");f.default.post("/hcm/hcmShop/setFocusShop",{shopids:a.join(",")}).then(function(t){"10000"==t.data.status?(e.showModal("shopVisible",!1),c.default.success(t.data.message),e.props.getShop()):c.default.error(t.data.message)}).catch(function(t){c.default.error(t.statusText)})}else c.default.warning("最少添加一个重点关注店铺")},e.handleItemOk=function(){var t=e.state.itemData,a=t.selectData.map(function(t){return t.id});if(0!=t.selectData.length){for(var n=0;n<a.length;n++)if(""==a[n])return void c.default.warning("第"+(n+1)+"条数据未选择单品，请选择后提交！");f.default.post("/hcm/hcmProduct/updateSingletPro",{product_id:a.join(",")}).then(function(t){"10000"==t.data.status?(e.showModal("itemVisible",!1),e.props.getItem(),c.default.success(t.data.message)):c.default.error(t.data.message)}).catch(function(t){c.default.error(t.statusText)})}else c.default.warning("最少添加一个重点关注单品")},e.getSingletProList=function(){f.default.get("/hcm/hcmProduct/findSingletProList").then(function(t){if("10000"==t.data.status){var a=e.state.itemData,n=t.data.data;a.selectData=n,e.setState({itemData:a})}else c.default.error(t.data.message)}).catch(function(t){c.default.error(t.statusText)})},e.getProductClassify=function(){f.default.get("/hcm/ProductClassify/list").then(function(t){if("10000"==t.data.status){var a=e.state.itemData,n=t.data.data;a.listData=n.map(function(t){return Object.assign({},t,{isLeaf:!1,label:t.productClassifyName,value:t.id})}),e.setState({itemData:a})}else c.default.error(t.data.message)}).catch(function(t){c.default.error(t.statusText)})},e.getlistByClass=function(t,e){f.default.get("/hcm/hcmProduct/listByClass",{params:{product_classify_id:t}}).then(function(t){"10000"==t.data.status?e(t.data.data):c.default.error(t.data.message)}).catch(function(t){c.default.error(t.statusText)})},e.onChangeCascaders=function(t,a,n){if(console.log(t,a),2==t.length){var s=e.state.itemData;s.selectData[n]={brand_name:a[1].brandName,id:t[1],product_classify_id:t[0],product_classify_name:a[0].productClassifyName,product_name:a[0].productClassifyName+"/"+a[1].productName},e.setState({itemData:s})}},e.loadData=function(t){var a=t[t.length-1];a.loading=!0,e.getlistByClass(a.id,function(t){var n=e.state.itemData;a.loading=!1;var s=t.map(function(t){return Object.assign({},t,{label:t.productName,value:t.id})});s.length?a.children=s:(a.disabled=!0,a.isLeaf=!0),n.listData=[].concat(function(t){if(Array.isArray(t)){for(var e=0,a=Array(t.length);e<t.length;e++)a[e]=t[e];return a}return Array.from(t)}(e.state.itemData.listData)),e.setState({itemData:n})})},e.addItem=function(){var t=e.state.itemData;t.selectData.push({brand_name:"",id:"",product_classify_id:"",product_classify_name:"",product_name:""}),e.setState({itemData:t})},e.rmItem=function(t){var a=e.state.itemData;1!=a.selectData.length?(a.selectData.splice(t,1),e.setState({itemData:a})):c.default.warning("最少保留一条")},e.state={id:null,itemVisible:!1,shopVisible:!1,shopData:{selectData:[],listData:[]},itemData:{selectData:[],listData:[]}},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(a,t.Component),d(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,a=this.state,c=a.itemVisible,d=a.shopVisible,f=a.shopData,p=a.itemData;return t.createElement(t.Fragment,null,t.createElement(s.default,{title:"重点关注店铺管理",okButtonProps:{className:"btn2-main"},cancelButtonProps:{className:"btn2-sub"},className:"add-shop-modal",visible:d,onCancel:function(){return e.showModal("shopVisible",!1)},onOk:this.handleshopOk},t.createElement(i.default,null,t.createElement(r.default,{className:"text-right",span:5},t.createElement("span",{style:{paddingRight:10,verticalAlign:"-4px"}},"店铺名称:")),t.createElement(r.default,{span:17,offse:1},f.selectData&&f.selectData.map(function(a,n){return t.createElement("div",{key:n,style:{marginBottom:"10px",display:"flex",alignItems:"center"}},t.createElement(u.default,{showSearch:!0,value:a.id,style:{width:"100%"},onChange:function(t){e.onShopSelect(t,n)},filterOption:function(t,e){return e.props.children[0].toLowerCase().indexOf(t.toLowerCase())>=0}},f.listData.map(function(e,a){return t.createElement(m,{key:a,disabled:!("NOTAUTH"!=e.isauthed&&!f.selectData.filter(function(t){return t.id==e.id}).length),value:e.id},e.shop_name," ","NOTAUTH"==e.isauthed?" (未订购) ":null)})),t.createElement(o.default,{onClick:function(t){return e.rmShop(n)},type:"minus-circle"}))}),t.createElement("div",{className:"addshop"},t.createElement(l.default,{style:{width:"100%"},disabled:f.selectData.length>=5,onClick:this.addShop,type:"dashed"},"添加"))))),t.createElement(s.default,{title:"重点关注单品管理",className:"add-shop-modal",okButtonProps:{className:"btn2-main"},cancelButtonProps:{className:"btn2-sub"},visible:c,onOk:this.handleItemOk,onCancel:function(){return e.showModal("itemVisible",!1)}},t.createElement(i.default,null,t.createElement(r.default,{className:"text-right",span:5},t.createElement("span",{style:{paddingRight:10,verticalAlign:"-4px"}},"商品名称:")),t.createElement(r.default,{span:17,offse:1},p.selectData.map(function(a,s){return t.createElement("div",{key:s,style:{marginBottom:"10px",display:"flex",alignItems:"center"}},t.createElement(n.default,{style:{width:"100%"},value:[a.product_classify_id,a.id],options:p.listData,onChange:function(t,a){return e.onChangeCascaders(t,a,s)},loadData:e.loadData,changeOnSelect:!0}),t.createElement(o.default,{onClick:function(t){return e.rmItem(s)},type:"minus-circle"}))}),t.createElement("div",{className:"addshop"},t.createElement(l.default,{style:{width:"100%"},disabled:p.selectData.length>=5,onClick:this.addItem,type:"dashed"},"添加"))))))}}]),a}();e.default=h}).call(this,a(1))},766:function(t,e){},768:function(t,e){}}]);