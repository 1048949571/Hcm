{"version":3,"sources":["webpack:///./app/widget/index/Shop/ActivityDetail/main.js"],"names":["DEFAULT_PAGE","pageNum","pageSize","COMMON","publicity","myActivity","shop","product","review","App","props","handleMoreClick","state","detailType","pagination","Object","assign","getCamDetailShop","getCamDetailPro","params","ser_day","moment","location","format","type","shop_id","id","campaign_node","ajax","get","then","res","data","status","message","setState","shopDetail","error","catch","product_id","proDetail","getMyActivityDetailInfo","myActivityDetail","breadcrumbName","match","warning","history","push","React","Component"],"mappings":"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","file":"js/chunk/336_330c4f9d9ed2db4352eb.js","sourcesContent":["import Tpl from './tpl'\r\nimport { message as Msg } from 'antd'\r\nimport ajax from '../../../../js/common/ajax'\r\n\r\nconst DEFAULT_PAGE = {\r\n  pageNum: 1,\r\n  pageSize: 10,\r\n}\r\n\r\nconst COMMON = {\r\n  publicity: '活动公示',\r\n  myActivity: '我的活动',\r\n\r\n  shop: 'shop',\r\n  product: 'product',\r\n  review: 'review',\r\n}\r\n\r\n// detailTYpe    shop:店铺活动详情 product:产品活动详情 review:我的活动详情\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      breadcrumbName: COMMON[props.match.params.breadcrumbName],\r\n      detailType: props.match.params.type,\r\n      id: props.match.params.id,\r\n      status: props.match.params.status,\r\n\r\n      myActivityDetail: {},\r\n      proDetail: {},\r\n      shopDetail: {},\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (this.state.detailType === COMMON.review) {\r\n      // 我的活动详情页面\r\n      this.getMyActivityDetailInfo()\r\n    }\r\n    if (this.state.detailType === COMMON.product) {\r\n      if (!this.props.location.state) {\r\n        Msg.warning('当前页面数据失效，准备跳往活动公示页面！', 1.5, () => {\r\n          this.props.history.push('/ActivityPublicity')\r\n        })\r\n      } else {\r\n        this.getCamDetailPro(DEFAULT_PAGE)\r\n      }\r\n    }\r\n    if (this.state.detailType === COMMON.shop) {\r\n      if (!this.props.location.state) {\r\n        Msg.warning('当前页面数据失效，准备跳往活动公示页面！', 1.5, () => {\r\n          this.props.history.push('/ActivityPublicity')\r\n        })\r\n      } else {\r\n        this.getCamDetailShop(DEFAULT_PAGE)\r\n      }\r\n    }\r\n  }\r\n  handleMoreClick = pageNum => {\r\n    if (this.state.detailType === 'shop') {\r\n      const pagination = Object.assign({}, DEFAULT_PAGE, {pageNum})\r\n      this.getCamDetailShop(pagination)\r\n    } \r\n    if (this.state.detailType === 'product') {\r\n      const pagination = Object.assign({}, DEFAULT_PAGE, {pageNum})\r\n      this.getCamDetailPro(pagination)\r\n    }\r\n  }\r\n  // 获取活动公示店铺详情\r\n  getCamDetailShop = (pagination) => {\r\n    const params = {\r\n      ser_day: moment(this.props.location.state.ser_day).format('YYYY-MM-DD'),\r\n      type: moment(this.props.location.state.ser_day).format('YYYY-MM-DD') === moment().format('YYYY-MM-DD') ? 1 : 2,\r\n      shop_id: `'${this.state.id}'`,\r\n      campaign_node: '已审核',\r\n      ...pagination,\r\n    }\r\n    ajax.get('/hcm/campgign/ScheduleBMC', {params}).then(res => {\r\n      const { data, status, message } = res.data\r\n      if (status === '10000') {\r\n        this.setState({\r\n          shopDetail: Object.assign({}, data, pagination),\r\n        })\r\n      } else {\r\n        Msg.error(message)\r\n      }\r\n    }).catch(err => {\r\n      Msg.error('系统繁忙，请稍后再试！')\r\n    })\r\n  }\r\n  // 获取活动公示产品详情\r\n  getCamDetailPro = (pagination) => {\r\n    const params = {\r\n      ser_day: moment(this.props.location.state.ser_day).format('YYYY-MM-DD'),\r\n      product_id: this.state.id,\r\n      ...pagination,\r\n    }\r\n    ajax.get('/hcm/campgign/findCamDetailPro',{params}).then(res => {\r\n      const { data, status, message } = res.data\r\n      if (status === '10000') {\r\n        this.setState({\r\n          proDetail: Object.assign({}, data, pagination),\r\n        })\r\n      } else {\r\n        Msg.error(message)\r\n      }\r\n    }).catch(err => {\r\n      Msg.error('系统繁忙，请稍后再试！')\r\n    })\r\n  }\r\n  // 获取我的活动详情信息\r\n  getMyActivityDetailInfo = () => {\r\n    const params = {\r\n      id: this.state.id,\r\n    }\r\n    ajax.get('/hcm/campgign/Detail', {params}).then(res => {\r\n      const { data, status, message } = res.data\r\n      if (status === '10000') {\r\n        this.setState({\r\n          myActivityDetail: Object.assign({}, data)\r\n        })\r\n      } else {\r\n        Msg.error(message)\r\n      }\r\n    }).catch(err => {\r\n      Msg.error('系统繁忙，请稍后再试！')\r\n    })\r\n  }\r\n  render() {\r\n    return <Tpl that={this} />\r\n  }\r\n}\r\n\r\nexport default App"],"sourceRoot":""}