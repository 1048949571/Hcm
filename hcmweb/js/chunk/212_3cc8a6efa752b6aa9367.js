(window.webpackJsonp=window.webpackJsonp||[]).push([[212],{1178:function(e,t){},156:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(770);t.default={Encrypt:function(e){var t=a.enc.Utf8.parse("hcmabcdefghijklm"),n=a.enc.Utf8.parse(e);return a.AES.encrypt(n,t,{mode:a.mode.ECB,padding:a.pad.Pkcs7}).toString()},Decrypt:function(e){var t=a.enc.Utf8.parse("hcmabcdefghijklm"),n=a.AES.decrypt(e,t,{mode:a.mode.ECB,padding:a.pad.Pkcs7});return a.enc.Utf8.stringify(n).toString()}}},62:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default={onVisibilityChange:function(e,t){var n="hidden"in document?"hidden":"webkitHidden"in document?"webkitHidden":"mozHidden"in document?"mozHidden":null,a=n.replace(/hidden/i,"visibilitychange"),i=function(){document[n]||console.log("页面非激活"+new Date),document[n]&&console.log("页面激活"+new Date)};document.addEventListener(a,i)},formatAccount:function(e){return e=e.replace(/[\s]/g,"").replace(/(\d{4})(?=\d)/g,"$1 ")},formatThousandMoney:function(t,n){return isNaN(t)?"":(n=n||"",!1===e.isNumeric(t)||0==t?"0.00":0==(t=(t=+t).toFixed(2))?"0.00":n+" "+(t+"").replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g,"$&,"))},encryption:function(){return(""+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")).replace(/(\d{3})\d*([0-9a-zA-Z]{4})/,"$1****$2")},browser:{versions:function(){var e=navigator.userAgent,t=(navigator.appVersion,"");if(e.indexOf("Ourydc.Yuebaobao")>-1){var n=e.match(/Ourydc.Yuebaobao.*/);if(n.length>0){var a=n[0];t=a.substr(a.indexOf("/")+1)}}return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Adr")>-1,iPhone:e.indexOf("iPhone")>-1,iPad:e.indexOf("iPad")>-1,webApp:-1==e.indexOf("Safari"),weixin:e.indexOf("MicroMessenger")>-1,weibo:"WeiBo"==e.match(/WeiBo/i)||"Weibo"==e.match(/Weibo/i)||"weibo"==e.match(/weibo/i),qq:"qq"==e.match(/qq/i)||"QQ"==e.match(/QQ/i),qqBrower:-1==e.indexOf("Mobile MQQBrowser")&&-1!=e.indexOf("MQQBrowser"),isInApp:e.indexOf("Ourydc.Yuebaobao")>-1,locAppVersion:t}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},checkAccount:function(e){return/^[a-zA-Z](\w|\s+){5,15}$/.test(this.trim(e||""))},checkUrl:function(e){return/^((ht|f)tps?):\/\/([\w\-]+(\.[\w\-]+)*\/)*[\w\-]+(\.[\w\-]+)*\/?(\?([\w\-\.,@?^=%&:\/~\+#]*)+)?/.test(this.trim(e||""))},Reg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return/^[^\u4e00-\u9fa5]{5,31}$/.test(this.trim(e||""))},checkPassword:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return/^.{6,16}$/.test(this.trim(e||""))},trim:function(e){return(e=""+e).replace(/(^\s*)|(\s*$)/g,"")},getCookie:function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]):null},required:function(e){var t=this.trim(e||"");return!(!t||!t.length)},legnthCheck:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"INPUT";return this.trim(e||"").length<this.LENGTH[t]},LENGTH:{URL:500,TEXTAREA:200,INPUT:50},getQueryString:function(e){var t=new RegExp("(^|&|[?])"+e+"=([^&]*)(&|$)"),n=window.location.href.substr(1).match(t);return null!=n?n[2]:""},getParamString:function(e,t){var n=new RegExp("(^|&|[?])"+t+"=([^&]*)(&|$)"),a=e.substr(1).match(n);return null!=a?a[2]:""},Trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},deviceCheck:function(){return browser.versions.mobile?browser.versions.android?"android":browser.versions.ios?"ios":"mobile":"web"}}}).call(this,n(112))},828:function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0});var i=h(n(24)),o=h(n(177)),r=h(n(11)),s=h(n(114)),u=h(n(15)),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(23),n(178),n(22),n(146),n(16);var l=h(n(630)),d=h(n(12)),f=h(n(156)),m=h(n(62));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g=function(t){function n(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return i.actionVisible=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i.setState({actionVisible:e,targetData:t},function(){e&&t.alid&&i.getOldaliList(t.alid),e&&t.jdid&&i.getOldjdList(t.jdid),i.setState({jdList:[],aliList:[],oldaliList:[],oldjdList:[]})})},i.getVersionList=function(){d.default.get("/hcm/sys/GetList",{params:{dictcode:"version"}}).then(function(e){i.setState({versionList:e.data.data})})},i.onBindSubmit=function(e,t){e.bmcid=i.state.targetData.bmcid,e.ALcomplaiontId=e.ALcomplaiontId.join(","),e.JDcomplaiontId=e.JDcomplaiontId.join(","),e.oldALcomplaiontId=i.state.targetData.alid,e.oldJDcomplaiontId=i.state.targetData.jdid,i.actionVisible(!1),i.setState({login:!0},function(){d.default.post("/hcm/complaiont/saveBmcid",e).then(function(e){"10000"==e.data.status?(i.getList(),t(),u.default.success(e.data.message),i.setState({login:!1})):(i.setState({login:!1}),u.default.error(e.data.message))}).catch(function(e){i.setState({login:!1}),u.default.error(e.statusText)})})},i.getComplaintsAccountListAli=function(e){""!=e?d.default.get("/hcm/complaiont/getList",{params:{platform:"ALIBABA",checkedids:i.state.oldaliList.map(function(e,t){return e.id}).join(","),keyword:e}}).then(function(e){i.setState({aliList:e.data.data})}).catch(function(e){u.default.error(e.statusText)}):i.setState({aliList:[]})},i.getComplaintsAccountListJd=function(e){""!=e?d.default.get("/hcm/complaiont/getList",{params:{platform:"JINGDONG",checkedids:i.state.oldjdList.map(function(e,t){return e.id}).join(","),keyword:e}}).then(function(e){i.setState({jdList:e.data.data})}).catch(function(e){u.default.error(e.statusText)}):i.setState({jdList:[]})},i.fetchUser=function(e,t){"aliList"==t?i.getComplaintsAccountListAli(e):i.getComplaintsAccountListJd(e)},i.onSelectBlur=function(e,t){i.setState(p({},t,[]))},i.getOldaliList=function(e){d.default.get("/hcm/complaiont/getMapByCheckids",{params:{platform:"ALIBABA",checkedids:e}}).then(function(e){i.setState({oldaliList:e.data.data||[]})}).catch(function(e){u.default.error(e.statusText)})},i.getOldjdList=function(e){d.default.get("/hcm/complaiont/getMapByCheckids",{params:{platform:"JINGDONG",checkedids:e}}).then(function(e){i.setState({oldjdList:e.data.data||[]})}).catch(function(e){u.default.error(e.statusText)})},i.onSelect=function(e,t,n,a){var o,r=i.state[n],s=r.filter(function(t,n){return t.id==e}),u=i.state[a];u.push(s[0]),i.setState((p(o={},a,u),p(o,n,r.filter(function(t,n){return t.id!=e})),o))},i.onDeselect=function(e,t,n,a){var o,r=i.state[a],s=r.filter(function(t,n){return t.id==e}),u=i.state[n];u.push(s[0]),i.setState((p(o={},a,r.filter(function(t,n){return t.id!=e})),p(o,n,u),o))},i.getUserCustomer=function(){d.default.get("/hcm/userin/getUserCustomer",{params:{status:1}}).then(function(e){console.log(e),i.setState({customerList:e.data.data})}).catch(function(e){u.default.error(e.statusText)})},i.getRolePage=function(){d.default.get("/hcm/role/getRolePage",{params:{pageNo:1,pageSize:999}}).then(function(e){i.setState({rolePage:e.data.data.content})})},i.chSearchIpt=function(e,t){var n=i.state;n[t]=e.target.value,i.setState(n)},i.handleClearIconClick=function(e){var t=i.state;t[e]=null,i.setState(t)},i.seSearchIpt=function(e,t){var n=i.state;n[t]=e,i.setState(n)},i.onSearch=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i.setState({pageNo:1,version:e?null:i.state.version,companyname:e?null:i.state.companyname,username:e?null:i.state.username,status:e?null:i.state.status,kefu:e?null:i.state.kefu,companyMemoname:e?null:i.state.companyMemoname,oldSearch:{version:e?null:i.state.version,companyname:e?null:i.state.companyname,username:e?null:i.state.username,status:e?null:i.state.status,kefu:e?null:i.state.kefu,companyMemoname:e?null:i.state.companyMemoname}},function(){i.getList()})},i.getList=function(){var e=i.state,t=e.version,n=e.companyname,a=e.username,o=e.status,r=e.companyMemoname,s=e.kefu,c=e.pageNo,l=e.pageSize;d.default.get("/hcm/userout/getUserPage",{params:{version:t,companyname:n,status:o,kefu:s,username:a,companyMemoname:r,pageNo:c,pageSize:l}}).then(function(e){i.setState({dataList:e.data.data.content,pageNo:e.data.data.pageNumber,pageSize:e.data.data.pageSize,totalNum:e.data.data.totalElements},function(){i.allClick(!0)})}).catch(function(e){u.default.error(e.statusText)})},i.allClick=function(t){var n=i.state.columns;if(1==t)return"checkStatue"==n[0].key&&n.splice(0,1),void i.setState({columns:n});"checkStatue"==n[0].key?n.splice(0,1):n.unshift({title:"",dataIndex:"checkStatue",key:"checkStatue",width:"4%",render:function(t,n,a){return e.createElement(s.default,{checked:n.checkStatue,onChange:function(e){return i.onCheckbox(e,t,n,a)}})}}),i.setState({columns:n})},i.checkAll=function(e){var t=i.state.dataList;t.forEach(function(t,n){t.checkStatue=e}),i.setState({dataList:t,checkAll:e})},i.changePagination=function(e,t){i.setState({pageNo:e,pageSize:t},function(){i.getList()})},i.onPaginationSize=function(e,t){i.setState({pageNo:1,pageSize:t},function(){i.getList()})},i.fullSpinVisible=function(e){i.setState({fullSpinVisible:e})},i.allStart=function(){var e=[],t=i.state.oldSearch,n=t.companyname,a=t.username,o=t.companyMemoname,r=t.status,s=t.kefu,c=t.version;i.state.dataList.filter(function(e,t){return e.checkStatue}).forEach(function(t,n){e.push(t.userid)}),0!=e.length?(i.fullSpinVisible(!0),d.default.post("/hcm/user/StartOrStop",{userIds:i.state.checkAll?"checkAllBmc":e.join(","),status:1,usertype:"c",companyname:i.state.checkAll?n:"",username:i.state.checkAll?a:"",companyMemoname:i.state.checkAll?o:"",status1:i.state.checkAll?r:"",kefu:i.state.checkAll?s:"",version:i.state.checkAll?c:""}).then(function(e){i.fullSpinVisible(!1),"10000"==e.data.status?(i.onSearch(!0),u.default.success(e.data.message)):u.default.error(e.data.message)}).catch(function(e){i.fullSpinVisible(!1),u.default.error(e.statusText)})):u.default.error("至少选择一条")},i.allStop=function(){var e=[],t=i.state.oldSearch,n=t.companyname,a=t.username,o=t.companyMemoname,r=t.status,s=t.kefu,c=t.version;i.state.dataList.filter(function(e,t){return e.checkStatue}).forEach(function(t,n){e.push(t.userid)}),0!=e.length?(i.fullSpinVisible(!0),d.default.post("/hcm/user/StartOrStop",{userIds:i.state.checkAll?"checkAllBmc":e.join(","),status:0,usertype:"c",companyname:i.state.checkAll?n:"",username:i.state.checkAll?a:"",companyMemoname:i.state.checkAll?o:"",status1:i.state.checkAll?r:"",kefu:i.state.checkAll?s:"",version:i.state.checkAll?c:""}).then(function(e){i.fullSpinVisible(!1),"10000"==e.data.status?(i.onSearch(!0),u.default.success(e.data.message)):u.default.error(e.data.message)}).catch(function(e){i.fullSpinVisible(!1),u.default.error(e.statusText)})):u.default.error("至少选择一条")},i.aAction=function(e,t,n){d.default.post(e,{userIds:t,status:n,usertype:"c"}).then(function(e){u.default.success(e.data.message),"10000"==e.data.status&&i.getList()}).catch(function(e){u.default.error(e.statusText)})},i.handleSubmit=function(e){e.preventDefault();var t=function(e,t){d.default.post(e,t).then(function(e){LoadingModal({bl:!1}),u.default.success(e.data.message),"10000"==e.data.status&&(i.stateModal(!1,"",!1),i.getList())}).catch(function(e){LoadingModal({bl:!1}),u.default.error(e.statusText)})};i.props.form.validateFields(function(e,n){if(!e){var o=i.state,r=o.targetModal,s=o.type;if(r.userid?n.userId=r.userid:n.userId=null,r.bid?n.bid=r.bid:n.bid=null,n.validtime=a(n.validtime).format("YYYY-MM-DD"),!m.default.required(n.companyname))return void u.default.error("请输入公司名称");if(!m.default.legnthCheck(n.companyname,"INPUT"))return void u.default.error("公司名称长度不允许超过50");if("新增"==s&&!m.default.checkAccount(n.username))return void u.default.error("请按照要求用户名");if(!m.default.checkPassword(n.password))return void u.default.error("密码长度不符");if(!m.default.required(n.kefuid)||n.kefuid&&0==n.kefuid.length)return void u.default.error("请选择服务客服");if(!m.default.legnthCheck(n.memo,"URL"))return void u.default.error("备注说明长度不允许超过500");LoadingModal({bl:!0,text:"保存中,请稍后..."}),n.companyname=m.default.trim(n.companyname),n.username=m.default.trim(n.username),n.password=f.default.Encrypt(m.default.trim(n.password)),n.kefuid=n.kefuid.join(","),"新增"==s?(n.userId="",n.bid="",t("/hcm/userout/saveUserOut",n)):"编辑"==s&&t("/hcm/userout/saveUserOut",n)}})},i.stateModal=function(e,t,n){!1===n&&(n={username:null,companyname:null,roleIds:null,versionid:null,kefu:null,Date:null,password:"******",memo:null}),n.password="******",n.roleIds=n.roleid,i.setState({visible:e,type:t,targetModal:n})},i.unBindphone=function(e){d.default.get("/hcm/user/UnbindPhone",{params:{mobiles:e.userid,usertype:"c"}}).then(function(e){u.default.success(e.data.message),"10000"==e.data.status&&i.getList()}).catch(function(e){u.default.error(e.statusText)})},i.allEditService=function(){var e=[],t=[];if(!m.default.required(i.state.oService)||i.state.oService&&0==i.state.oService.length)u.default.error("请选择服务客服");else{var n=i.state.oldSearch,a=n.companyname,o=n.username,r=n.companyMemoname,s=n.status,c=n.kefu,l=n.version;i.state.dataList.filter(function(e,t){return e.checkStatue}).forEach(function(n,a){e.push(n.userid),t.push(n.bid)}),d.default.post("/hcm/cus/multil_update_kefu",{bmcids:i.state.checkAll?null:t.join(","),userIds:i.state.checkAll?null:e.join(","),kefu:i.state.oService.join(","),checkAll:!!i.state.checkAll||null,companyname:i.state.checkAll?a:"",username:i.state.checkAll?o:"",companyMemoname:i.state.checkAll?r:"",status:i.state.checkAll?s:"",kefu1:i.state.checkAll?c:"",version:i.state.checkAll?l:""}).then(function(e){"10000"==e.data.status?(u.default.success(e.data.message),i.setState({editService:!1,oService:[]},function(){i.getList()})):u.default.error(e.data.message)}).catch(function(e){u.default.error(e.statusText)})}},i.selectService=function(e){i.setState({oService:e})},i.stateEditService=function(e){0!=i.state.dataList.filter(function(e,t){return e.checkStatue}).length?i.setState({editService:e,oService:[]}):u.default.error("至少选择一条")},i.state={fetching:!1,versionList:[],version:null,actionVisible:!1,jdList:[],aliList:[],oldaliList:[],oldjdList:[],targetData:{},rolePage:[],login:!1,fullSpinVisible:!1,type:null,oService:[],dataList:[],editService:!1,oldSearch:{companyname:null,username:null,companyMemoname:null,status:null,kefu:null},targetModal:{bid:null,username:null,roleIds:null,versionid:null,companyname:null,kefu:null,validtime:null,password:"******",memo:null,companyMemoname:null},customerList:[],companyname:null,status:null,username:null,companyMemoname:null,kefu:null,pageNo:1,pageSize:10,checkAll:!1,totalNum:null,columns:[{title:"序号",dataIndex:"index",key:"index",width:"5%",render:function(e,t,n){return n+1}},{title:"客户名称",dataIndex:"companyname",key:"companyname",width:"10%",render:function(t,n,a){return e.createElement("a",{href:"./index.html#/DepartmentManagements/"+n.bmcid+"/"+n.companyname},n.companyname)}},{title:"用户名",dataIndex:"username",key:"username",width:"10%"},{title:"绑定手机",dataIndex:"mobile",key:"mobile",width:"10%",render:function(t,n){return e.createElement("div",null,t&&t.length?t:"--",t&&t.length?e.createElement("span",{onClick:function(){return i.unBindphone(n)},className:"unphone"},e.createElement(r.default,{type:"link"}),"解绑手机"):null)}},{title:"服务客服",dataIndex:"kefuname",key:"kefuname",width:"10%"},{title:"备注说明",dataIndex:"memo",key:"memo",width:"10%"},{title:"备注名",dataIndex:"companyMemoname",key:"companyMemoname",width:"10%"},{title:"账号有效期",dataIndex:"validtime",key:"validtime",width:"10%",render:function(e){return e?a(e).format("YYYY-MM-DD"):null}},{title:"状态",dataIndex:"status",key:"status",width:"4%",render:function(t,n,a){return e.createElement(o.default,{checked:"1"==t,onChange:function(){return i.aAction("/hcm/user/StartOrStop",n.userid,"1"==t?0:1)},checkedChildren:"开",unCheckedChildren:"关",defaultChecked:!0})}},{title:"操作",key:"action",align:"right",width:"10%",render:function(t,n,a){return e.createElement("span",{key:"index"},e.createElement("a",{onClick:function(){return i.stateModal(!0,"编辑",n)}},e.createElement("img",{style:{verticalAlign:"text-bottom",paddingRight:"4px"},src:"../../../img/icon/icon_operating_edit.png"}),"编辑"),e.createElement("a",{style:{marginLeft:10},onClick:function(){return i.actionVisible(!0,n)}},"绑定"))}}]},i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,e.Component),c(n,[{key:"componentDidMount",value:function(){this.getList(),this.getUserCustomer(),this.getRolePage(),this.getVersionList()}},{key:"onCheckbox",value:function(e,t,n,a){var i=this.state.dataList;i[a].checkStatue?i[a].checkStatue=!1:i[a].checkStatue=!0,this.setState({dataList:i,checkAll:!1})}},{key:"render",value:function(){return e.createElement(l.default,{that:this})}}]),n}();t.default=i.default.create()(g)}).call(this,n(1),n(10))}}]);