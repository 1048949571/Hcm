{"version":3,"sources":["webpack:///./app/widget/index/Brand/OrderInformation/main.js"],"names":["DEFAULT_PAGE","pageNo","pageSize","App","props","clearInputFn","setState","key","searchChange","type","param","target","value","length","startTime","endTime","getDataList","params","axios","get","then","res","data","status","message","dataList","content","map","Object","assign","v","_isExpand","pagination","state","pageNumber","totalElements","expandedRowKeys","error","catch","handleOrder","orderId","flag","LoadingModal","bl","post","orderState","success","commonSearchData","shopId","highPrice","lowPrice","warning","undefined","isNaN","parseInt","orderNo","fmoney","lmoney","firstDate","format","lastDate","handleSearch","handlePageChange","page","handleExpand","expanded","record","index","findIndex","id","copyDataList","copyObj","_detail","statusText","showTableList","filter","match","shopName","wangwang","moment","subtract","React","Component"],"mappings":"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","file":"js/chunk/262_03f222401a147ed2455e.js","sourcesContent":["import Tpl from './tpl'\r\nimport { message as Msg } from 'antd'\r\nimport axios from '../../../../js/common/ajax'\r\n\r\nconst DEFAULT_PAGE = {\r\n  pageNo: 1,\r\n  pageSize: 10,\r\n}\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      shopId: props.match.params.shopId,\r\n      shopName: props.match.params.shopName,\r\n      wangwang: props.match.params.wangwang,\r\n      orderId: '',\r\n      // buyerName: '',\r\n      // shopInfo: '',\r\n      status: '',\r\n      // result: '',\r\n      highPrice: '',\r\n      lowPrice: '',\r\n      startTime: moment().subtract(6, 'd'),\r\n      endTime: moment(),\r\n      expandedRowKeys: [],\r\n      expanded: false,\r\n\r\n      dataList: [],\r\n      pagination: {...DEFAULT_PAGE},\r\n    }\r\n  }\r\n  clearInputFn = key => {\r\n    this.setState({\r\n      [key]: ''\r\n    })\r\n  }\r\n  componentDidMount() {\r\n    this.getDataList(this.commonSearchData(DEFAULT_PAGE))\r\n  }\r\n  searchChange = (key, type, param) => {\r\n    switch(type) {\r\n      case 'input':\r\n        // console.log(param.target.value)\r\n        this.setState({\r\n          [key]: param.target.value,\r\n        })\r\n        break\r\n      case 'select':\r\n        // console.log(param)\r\n        this.setState({\r\n          [key]: param,\r\n        })\r\n        break\r\n      case 'time':\r\n        // console.log(param)\r\n        if (param.length === 0) {\r\n          this.setState({\r\n            startTime: '',\r\n            endTime: '',\r\n          })\r\n        } else {\r\n          this.setState({\r\n            startTime: param[0],\r\n            endTime: param[1],\r\n          })\r\n        }\r\n      default:\r\n        null\r\n    }\r\n  }\r\n  // 获取数据列表\r\n  getDataList = (params) => {\r\n    // console.log(params)\r\n    // return\r\n    axios.get('/hcm/hcmShopMonitor/findOrderShopListByPage', {params}).then(res => {\r\n      const { data, status, message } = res.data\r\n      if (status === '10000') {\r\n        this.setState({\r\n          dataList: data.content.length===0?[]:data.content.map(v => Object.assign({}, v, {_isExpand:false})),\r\n          pagination: Object.assign({}, this.state.pagination, {\r\n            pageNo: data.pageNumber,\r\n            pageSize: data.pageSize,\r\n            totalElements: data.totalElements,\r\n          }),\r\n          expandedRowKeys: [],\r\n        })\r\n      } else {\r\n        Msg.error(message)\r\n      }\r\n    }).catch(err => {\r\n      Msg.error('系统繁忙，请稍后再试！')\r\n    })\r\n  }\r\n  handleOrder = (orderId, flag) => {\r\n    // console.log(flag)\r\n    LoadingModal({bl:true})\r\n    axios.post('/hcm/hcmShopMonitor/updateOrderAbnormal', {\r\n      orderId,\r\n      orderState: flag,\r\n    }).then(res => {\r\n      LoadingModal({bl:false})\r\n      const { data, status, message } = res.data\r\n      if (status === '10000') {\r\n        data == 1 && Msg.success(message)\r\n        this.getDataList(this.commonSearchData(DEFAULT_PAGE))\r\n      } else {\r\n        Msg.error(message)\r\n      }\r\n    }).catch(err => {\r\n      LoadingModal({bl:false})\r\n      Msg.error('系统繁忙，请稍后再试！')\r\n    })\r\n  }\r\n  commonSearchData = pagination => {\r\n    const {\r\n      shopId,\r\n      orderId,\r\n      // buyerName,\r\n      status,\r\n      startTime,\r\n      endTime,\r\n      highPrice,\r\n      lowPrice,\r\n    } = this.state\r\n    if (startTime === '' || endTime === '') {\r\n      Msg.warning('时间不能为空，请选择时间！')\r\n      return undefined\r\n    }\r\n    // if (lowPrice !== '' || highPrice !== '') {\r\n    if ( (lowPrice !== ''&&isNaN(parseInt(lowPrice,10))) || (highPrice !== ''&&isNaN(parseInt(highPrice,10))) ) {\r\n      Msg.warning('请输入数字价格！')\r\n      return undefined\r\n    }\r\n    if (lowPrice !== '' && highPrice !== '' && parseInt(lowPrice,10) > parseInt(highPrice,10)) {\r\n      Msg.warning('最低价不能超过最高价！')\r\n      return undefined\r\n    }\r\n    // }\r\n    const data = {\r\n      shopId,\r\n      // nick: buyerName,\r\n      orderNo: orderId,\r\n      orderState: status,\r\n      fmoney: lowPrice,\r\n      lmoney: highPrice,\r\n      firstDate: startTime.format('YYYY-MM-DD'),\r\n      lastDate: endTime.format('YYYY-MM-DD'),\r\n      pageNo: pagination.pageNo,\r\n      pageSize: pagination.pageSize,\r\n    }\r\n    return data\r\n  }\r\n  handleSearch = () => {\r\n    const data = this.commonSearchData(DEFAULT_PAGE)\r\n    if (data) {\r\n      this.getDataList(data)\r\n    }\r\n  }\r\n  handlePageChange = page => {\r\n    this.setState({\r\n      pagination: Object.assign({}, this.state.pagination, {\r\n        pageNo: page,\r\n      })\r\n    }, () => {\r\n      const data = this.commonSearchData(this.state.pagination)\r\n      if (data) {\r\n        this.getDataList(data)\r\n      }\r\n    })\r\n  }\r\n  handleExpand = async (expanded, record) => {\r\n    // console.log(expanded)\r\n    const { dataList } = this.state\r\n    const index = dataList.findIndex(v => v.id == record.id)\r\n    if (index < 0) {\r\n      Msg.error('系统异常，请稍后再试！')\r\n      return\r\n    }\r\n    const copyDataList = [...dataList]\r\n    const copyObj = Object.assign({}, copyDataList[index])\r\n    copyObj._isExpand = !record._isExpand\r\n    if (!record._isExpand && record._detail === undefined) {\r\n      // 请求额外数据并且添加到当前数据中\r\n      try {\r\n        LoadingModal({bl:true})\r\n        const res = await axios.get('/hcm/hcmShopMonitor/getOrderDetailById', {params: { orderId: record.id }})\r\n        LoadingModal({bl:false})\r\n        if (res.data.status !== '10000') {\r\n          Msg.error(res.data.message)\r\n          return\r\n        }\r\n        copyObj._detail = {...res.data.data}\r\n      } catch (error) {\r\n        LoadingModal({bl:false})\r\n        Msg.error(error.statusText)\r\n        return\r\n      }\r\n    }\r\n    copyDataList[index] = copyObj\r\n    const showTableList = copyDataList.filter(v => v._isExpand)\r\n    const expandedRowKeys = showTableList.length?showTableList.map(v => v.id):[]\r\n    this.setState({\r\n      expandedRowKeys,\r\n      dataList: copyDataList,\r\n    })\r\n  }\r\n  render() {\r\n    return <Tpl that={this} />\r\n  }\r\n}\r\n\r\nexport default App"],"sourceRoot":""}