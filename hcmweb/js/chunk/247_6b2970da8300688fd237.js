(window.webpackJsonp=window.webpackJsonp||[]).push([[247],{866:function(t,e,a){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0});var o=m(a(15)),r=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var a=[],n=!0,o=!1,r=void 0;try{for(var i,c=t[Symbol.iterator]();!(n=(i=c.next()).done)&&(a.push(i.value),!e||a.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{!n&&c.return&&c.return()}finally{if(o)throw r}}return a}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},c=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();a(16);var s=m(a(638)),p=m(a(135)),u=m(a(12));function m(t){return t&&t.__esModule?t:{default:t}}var l={pageNo:1,pageSize:10},h=function(e){function a(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return c.handleTabChange=function(t,e){"2"===t&&(c.getImportantShopSalesRank(c.commonParams(i({},l,{product_id:e}))),c.getImportantVipPercent(c.commonParams(i({},l,{product_id:e}))),c.setState({importantProductDefaultKey:e})),"1"===t&&(c.getProductSalesRank(c.commonParams(i({},l,{shopId:e}))),c.setState({shopImportantDefaultKey:e}))},c.handlePageChange=function(t,e){var a={pageNo:e,pageSize:l.pageSize};"getProductSalesRank"===t&&(a.shopId=c.state.shopImportantDefaultKey),"getImportantVipPercent"!==t&&"getImportantShopSalesRank"!==t||(a.product_id=c.state.importantProductDefaultKey),c[t](c.commonParams(a))},c.commonParams=function(t){var e={start_time:c.state.start_time.format("YYYY-MM-DD")+" 00:00:00",end_time:c.state.end_time.format("YYYY-MM-DD")+" 23:59:59",pageNo:t.pageNo,pageSize:t.pageSize};return t.product_id&&(e.product_id=t.product_id),t.shopId&&(e.shopId=t.shopId),e},c.handleTimeChange=function(t){0!==t.length?c.setState({start_time:t[0],end_time:t[1]},function(){c.getHotProductSalesRank(c.commonParams(l)),c.getCategorySalesRank(c.commonParams(l)),c.getImportantProductData(),c.getVipProvincePercent(c.commonParams(l)),c.getVipCityPercent(c.commonParams(l)),c.getShopSalesRank(c.commonParams(l)),c.getShopImportantList()}):o.default.warning("时间不能为空！")},c.getChartData=function(){u.default.get("/hcm/hcmShopMonitor/getSalesYear").then(function(t){var e=t.data,a=e.data,n=e.status,r=e.message;"10000"===n?c.setState({chartData:a},function(){c.inChart()}):o.default.error(r)}).catch(function(t){o.default.error("系统繁忙，请稍后再试！")})},c.inChart=function(){var t=c.state.chartData;p.default.init(document.getElementById("chart-bar")).setOption({tooltip:{trigger:"axis",formatter:function(t){var e=r(t,2),a=e[0],n=e[1];return"<div class='tooltip'>\n                            "+(a?"\n                                <p>\n                                    <span style='background-color:"+a.color+";'></span>\n                                    "+a.seriesName+":"+a.value+"\n                                </p>\n                                ":"")+"\n                            "+(n?"\n                                <p>\n                                    <span style='background-color:"+n.color+";'></span>\n                                    "+n.seriesName+":"+n.value+"\n                                </p>\n                                ":"")+"\n                        </div>"}},grid:{left:60,top:30,bottom:20,right:60},xAxis:[{type:"category",axisLine:{lineStyle:{color:"#999"}},data:t.month}],yAxis:[{type:"value",name:"单位（ 单 ）",axisTick:{show:!1},axisLine:{show:!1},splitLine:{lineStyle:{type:"dashed"}},axisLabel:{formatter:"{value}"}},{type:"value",name:"单位（ 万元 ）",axisTick:{show:!1},axisLine:{show:!1},splitLine:{show:!1},axisLabel:{formatter:"{value}"}}],series:[{name:"订单数",type:"bar",barGap:0,yAxisIndex:0,itemStyle:{color:"#3AA1FF"},data:t.ordernumList},{name:"销售额",type:"bar",barGap:0,yAxisIndex:1,itemStyle:{color:"#4ECB73"},data:t.salesList}]})},c.getShopSalesRank=function(t){c.getFn("/hcm/hcmShopMonitor/getShopMoneyTop","shopSalesRank",t)},c.getShopImportantList=function(){u.default.get("/hcm/hcmShop/getShopListByBmcid",{params:{focus:1}}).then(function(t){var e=t.data,a=e.data,n=e.status,r=e.message;"10000"===n?c.setState({shopImportantList:a,shopImportantDefaultKey:a.length?a[0].id:""},function(){0!==a.length&&c.getProductSalesRank(c.commonParams(i({},l,{shopId:a[0].id})))}):o.default.error(r)}).catch(function(t){o.default.error("系统繁忙，请稍后再试！")})},c.getProductSalesRank=function(t){c.getFn("/hcm/hcmShopMonitor/getShopProductTop","productSalesRank",t)},c.getVipProvincePercent=function(t){c.getFn("/hcm/hcmShopMonitor/getOrderInfoSubAnalysisStrict","vipProvincePercent",t)},c.getVipCityPercent=function(t){c.getFn("/hcm/hcmShopMonitor/getOrderInfoSubAnalysisCity","vipCityPercent",t)},c.getCategorySalesRank=function(t){c.getFn("/hcm/hcmShopMonitor/findClassifyItemSort","categorySalesRank",t)},c.getHotProductSalesRank=function(t){c.getFn("/hcm/hcmShopMonitor/findHotSingletItemSort","hotProductSalesRank",t)},c.getImportantProductData=function(){u.default.get("/hcm/hcmProduct/findSingletProList").then(function(t){var e=t.data,a=e.data,n=e.status,r=e.message;"10000"===n?c.setState({importantProductList:a,importantProductDefaultKey:a.length?a[0].id:""},function(){0!==a.length&&(c.getImportantShopSalesRank(c.commonParams(i({},l,{product_id:a[0].id}))),c.getImportantVipPercent(c.commonParams(i({},l,{product_id:a[0].id}))))}):o.default.error(r)}).catch(function(t){o.default.error("系统繁忙，请稍后再试！")})},c.getImportantShopSalesRank=function(t){c.getFn("/hcm/hcmShopMonitor/findImpShopSort","importantShopSalesRank",t)},c.getImportantVipPercent=function(t){c.getFn("/hcm/hcmShopMonitor/findImpBuyerSort","importantVipPercent",t)},c.getFn=function(t,e,a){u.default.get(t,{params:a}).then(function(t){var a=t.data,n=a.data,r=a.status,i=a.message;"10000"===r?c.setState(function(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}({},e,{list:n.content,pageNo:n.pageNumber,pageSize:n.pageSize,totalElements:n.totalElements})):o.default.error(i)}).catch(function(t){o.default.error("系统繁忙，请稍后再试！")})},c.AddModal=t.createRef(),c.state={id:null,chartData:{},start_time:n().subtract(30,"d"),end_time:n(),importantProductList:[],importantProductDefaultKey:"",importantShopSalesRank:{},importantVipPercent:{},hotProductSalesRank:{},categorySalesRank:{},shopSalesRank:{},productSalesRank:{},shopImportantList:[],shopImportantDefaultKey:"",vipProvincePercent:{},vipCityPercent:{}},c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(a,t.Component),c(a,[{key:"componentDidMount",value:function(){this.getChartData(),this.getHotProductSalesRank(this.commonParams(l)),this.getCategorySalesRank(this.commonParams(l)),this.getImportantProductData(),this.getVipProvincePercent(this.commonParams(l)),this.getVipCityPercent(this.commonParams(l)),this.getShopSalesRank(this.commonParams(l)),this.getShopImportantList()}},{key:"render",value:function(){return t.createElement(s.default,{that:this})}}]),a}();e.default=h}).call(this,a(1),a(10))}}]);