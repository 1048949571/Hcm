{"version":3,"sources":["webpack:///./app/widget/index/Service/PluginSummary/main.js"],"names":["App","props","handleRowSelection","selectedRowKeys","selectedRows","setState","selectedTableRows","length","map","v","id","isCheckedAll","handleClearInput","key","getDataList","state","platform","start_time","end_time","pagination","wangwang","itemid","LoadingModal","bl","axios","post","format","pageNo","pageSize","then","result","handleResponse","res","dataList","content","Object","assign","pageNumber","totalElements","totalPages","catch","handleResponseError","selectAll","cancelAll","pageChange","page","handleDelete","warning","data","ids","join","success","message","handleSearchSubmit","getFieldsValue","e","preventDefault","values","times","getPlatformDict","platformList","can","status","error","undefined","err","statusText","moment","subtract","React","Component"],"mappings":"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","file":"js/chunk/330_945cd1c209f744443cd0.js","sourcesContent":["import Tpl from './tpl'\r\nimport axios from '../../../../js/common/ajax'\r\nimport { message as Msg } from 'antd'\r\n// import { LoadingModal } from '../../../components/LoadingModal/LoadingModal'\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      platformList: [],\r\n      platform: '',\r\n      start_time: moment(moment().subtract(6, 'd').format('YYYY-MM-DD'), 'YYYY-MM-DD HH:mm:ss'),\r\n      end_time: moment(moment().format('YYYY-MM-DD')+'T23:59:59', 'YYYY-MM-DD HH:mm:ss'),\r\n      wangwang: '',\r\n      itemid: '',\r\n      pagination: {\r\n        pageNo: 1,\r\n        pageSize: 10,\r\n      },\r\n      dataList: [],\r\n      selectedTableRows: [],\r\n      isCheckedAll: false,\r\n    }\r\n  }\r\n  componentWillMount() {\r\n    this.getPlatformDict()\r\n    this.getDataList()\r\n  }\r\n  // 选择表格数据\r\n  handleRowSelection = (selectedRowKeys, selectedRows) => {\r\n    // console.log(`selectedRowKeys: ${selectedRowKeys}`, 'selectedRows: ', selectedRows);\r\n    this.setState({\r\n      selectedTableRows: selectedRows.length?selectedRows.map(v => v.id):[],\r\n      isCheckedAll: false,\r\n    })\r\n  }\r\n  // 清除搜索数据\r\n  handleClearInput = key => {\r\n    this.setState({\r\n      [key]: ''\r\n    })\r\n  }\r\n  // 获取表格数据\r\n  getDataList = () => {\r\n    const { platform, start_time, end_time, pagination, wangwang, itemid } = this.state\r\n    LoadingModal({bl:true})\r\n    axios.post('/hcm/plugin/getPluginList', {\r\n      platform,\r\n      start_time: start_time.format('YYYY-MM-DD HH:mm:ss'),\r\n      end_time: end_time.format('YYYY-MM-DD HH:mm:ss'),\r\n      wangwang,\r\n      itemid,\r\n      // ...pagination,\r\n      pageNo: pagination.pageNo,\r\n      pageSize: pagination.pageSize,\r\n    }).then(res => {\r\n      LoadingModal({bl:false})\r\n      const result = this.handleResponse(res)\r\n      this.setState({\r\n        dataList: result.content,\r\n        pagination: Object.assign({}, this.state.pagination, {\r\n          pageNo: result.pageNumber,\r\n          pageSize: result.pageSize,\r\n          totalElements: result.totalElements,\r\n          totalPages: result.totalPages,\r\n        })\r\n      })\r\n    }).catch(this.handleResponseError)\r\n  }\r\n  // 选择时间\r\n  // dateChange = (dates) => {\r\n  //   if (dates.length) {\r\n  //     this.setState({\r\n  //       start_time: dates[0],\r\n  //       end_time: dates[1],\r\n  //     })\r\n  //   }\r\n  // }\r\n  // 选择全部\r\n  selectAll = () => {\r\n    this.setState({\r\n      isCheckedAll: true,\r\n      selectedTableRows: [...this.state.dataList.map(v => v.id)],\r\n    })\r\n  }\r\n  // 取消选择\r\n  cancelAll = () => {\r\n    this.setState({\r\n      isCheckedAll: false,\r\n      selectedTableRows: [],\r\n    })\r\n  }\r\n  // 分页查询\r\n  pageChange = page => {\r\n    // console.log(page)\r\n    this.setState({\r\n      pagination: Object.assign({}, this.state.pagination, {\r\n        pageNo: page,\r\n      })\r\n    }, () => {\r\n      this.getDataList()\r\n    })\r\n  }\r\n  // 批量删除\r\n  handleDelete = () => {\r\n    const { isCheckedAll, selectedTableRows, platform, start_time, end_time, wangwang, itemid } = this.state\r\n\r\n    if (!selectedTableRows.length) {\r\n      Msg.warning('请至少选择一条记录！')\r\n      return\r\n    }\r\n\r\n    const data = {\r\n      platform,\r\n      start_time: start_time.format('YYYY-MM-DD HH:mm:ss'),\r\n      end_time: end_time.format('YYYY-MM-DD HH:mm:ss'),\r\n      wangwang,\r\n      itemid,\r\n    }\r\n    if (isCheckedAll) {\r\n      data.ids = 'checkAll'\r\n    } else {\r\n      data.ids = selectedTableRows.join(',')\r\n    }\r\n    // console.log(data)\r\n    LoadingModal({bl:true})\r\n    axios.post('/hcm/plugin/deletePluginList', data).then(res => {\r\n      LoadingModal({bl:false})\r\n      const result = this.handleResponse(res)\r\n      if (result) {\r\n        Msg.success(res.data.message)\r\n        this.getDataList()\r\n        this.setState({\r\n          selectedTableRows: [],\r\n        })\r\n      }\r\n    }).catch(this.handleResponseError)\r\n  }\r\n  // 提交搜索数据\r\n  handleSearchSubmit = (getFieldsValue, e) => {\r\n    e.preventDefault();\r\n    const values = getFieldsValue()\r\n    if (!values.times.length) {\r\n      Msg.warning('请选择时间！')\r\n      return\r\n    }\r\n    this.setState({\r\n      platform: values.platform,\r\n      start_time: values.times[0],\r\n      end_time: values.times[1],\r\n      wangwang: values.wangwang?values.wangwang:'',\r\n      itemid: values.itemid?values.itemid:'',\r\n      pagination: Object.assign({}, this.state.pagination, {\r\n        pageNo: 1,\r\n      }),\r\n    }, () => {\r\n      this.getDataList()\r\n    })\r\n  }\r\n  // 获取平台字典值\r\n  getPlatformDict = () => {\r\n    // axios.get('/hcm/sys/GetList', {\r\n    //   params: {\r\n    //     dictcode: 'platform',\r\n    //   }\r\n    // }).then(res => {\r\n    //   const result = this.handleResponse(res)\r\n    //   if (result) {\r\n        this.setState({\r\n          platformList: can.platform||[]\r\n        })\r\n    //   }\r\n    // }).catch(this.handleResponseError)\r\n  }\r\n  handleResponse = (res) => {\r\n    const { data, status, message } = res.data\r\n    if (status === '10000') {\r\n      return data\r\n    } else {\r\n      Msg.error(message)\r\n      return undefined\r\n    }\r\n  }\r\n  handleResponseError = (err) => {\r\n    LoadingModal({bl:false})\r\n    Msg.error(err.statusText)\r\n  }\r\n  render() {\r\n    return <Tpl that={this} />\r\n  }\r\n}\r\n\r\nexport default App"],"sourceRoot":""}